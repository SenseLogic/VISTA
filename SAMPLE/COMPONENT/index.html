<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Sample</title>
    </head>
    <body>
        <main style="font-family:monospace">
            <test-component click-count="1">
            </test-component>
        </main>
        <script src="../../CODE/JAVASCRIPT/vista_base.js"></script>
        <script src="../../CODE/JAVASCRIPT/vista_math.js"></script>
        <script src="../../CODE/JAVASCRIPT/vista_element.js"></script>
        <script src="../../CODE/JAVASCRIPT/vista_component.js"></script>
        <script src="../../CODE/JAVASCRIPT/vista_breakpoint.js"></script>
        <script>
            // -- TYPES

            class TEST_COMPONENT extends VISTA_COMPONENT
            {
                // -- INQUIRIES

                static get observedAttributes(
                    )
                {
                    return [ "text-color", "click-count" ];
                }

                // -- OPERATIONS

                SetRandomReal(
                    event
                    )
                {
                    this.RandomReal = event.detail.RandomReal;
                    this.SetChanged();
                }

                // ~~

                SetTextColorProperty(
                    event
                    )
                {
                    this.SetProperty( "TextColor", "#" + GetByteArrayHexadecimalText( GetRandomByteArray( 3 ) ) );
                    event.target.EmitEvent( "set-random-real", { RandomReal : GetRandomReal( 0.0, 10.0 ) } );
                }

                // ~~

                SetClickCountProperty(
                    event
                    )
                {
                    this.SetProperty( "ClickCount", this.ClickCount + 1 );
                }

                // ~~

                SetClickCountAttribute(
                    event
                    )
                {
                    this.SetAttribute( "click-count", this.ClickCount + 1 );
                }

                // ~~

                InitializeComponent(
                    )
                {
                    this.MovieArray =
                        [
                            {
                                Name : "<Blade Runner>",
                                Rating : 5
                            },
                            {
                                Name : "<The Chronicles of Riddick>",
                                Rating : 4
                            },
                            {
                                Name : "<The Matrix>",
                                Rating : 3
                            }
                        ];
                    this.RandomReal = 0.0;

                    this.BindProperty( "TextColor", "text-color", "#0000ff" );
                    this.BindProperty( "ClickCount", "click-count", 0 );

                    this.BindMethod( "SetRandomReal" );
                    this.BindMethod( "SetTextColorProperty" );
                    this.BindMethod( "SetClickCountProperty" );
                    this.BindMethod( "SetClickCountAttribute" );

                    this.BindEvent( this, "set-random-real", this.SetRandomReal );

                    this.AttachShadow();
                    this.SetTemplate(
                        Html`
                        <style>
                            :host .button
                            {
                                border: none;
                                border-radius: (:8 pxm:);
                                padding: (:8 pxm:) (:16 pxm:);
                                background-color: <:# this.TextColor :>;
                                color: cyan;

                                @media (:above-30em:) and (:below-40em:), (:above-50em:)
                                {
                                    color: white;
                                }

                                @media (:above-60em:)
                                {
                                    color: yellow;
                                }
                            }

                            :host .button
                            {
                                @media (:above-60em:)
                                {
                                    background-color: magenta;
                                }
                            }

                            @media (:above-70em:)
                            {
                                :host .button
                                {
                                    background-color: red;
                                }
                            }
                        </style>
                        <button id="property-button" class="button">
                            <:# this.TextColor :> : <:# this.ClickCount :>
                        </button>
                        <button id="attribute-button" class="button">
                            <:# this.TextColor :> : <:# this.ClickCount :>
                        </button>
                        <ul>
                            <: for ( var movie of this.MovieArray ) { :>
                                <li style="color:<:# this.TextColor :>">
                                    <:% movie.Name :> : <:# movie.Rating :>
                                </li>
                            <: } :>
                        </ul>
                        <div ignored="<\: ignored :\>">
                            <: var ignored = "<\: ignored :\>"; :>
                        </div>
                        <div>
                            <:# this.RandomReal :>
                        </div>
                        `
                        );
                }

                // ~~

                UpdateComponent(
                    )
                {
                    super.UpdateComponent();

                    this.BindEvent( this.GetElements( ".button" ), "click", this.SetTextColorProperty );
                    this.BindEvent( this.GetElement( "#property-button" ), "click", this.SetClickCountProperty );
                    this.BindEvent( this.GetElement( "#attribute-button" ), "click", this.SetClickCountAttribute );
                }
            }

            // -- STATEMENTS

            DefineTemplateFilter( " pxm", ( expression ) => eval( expression ) * 0.0625 + "rem" );
            DefineComponent( TEST_COMPONENT, "test-component" );
        </script>
    </body>
</html>
